<html>
<head>
<!-- <mosyncheadertags>
<meta name="description" content="MoSync graphics operations are always performed to a &quot;draw target&quot;. By default, this draw target is the screen, but you can create images that can be drawn to, using maCreateDrawableImage()." />
<meta name="dcterms.description" content="MoSync graphics operations are always performed to a &quot;draw target&quot;. By default, this draw target is the screen, but you can create images that can be drawn to, using maCreateDrawableImage()." />

<title>Draw Targets, Clipping | MoSync Guide/Tutorial</title>
</mosyncheadertags> -->
</head>
<body>
<h1>Draw Targets, Clipping</h1>
<p>MoSync graphics operations are always performed to a "draw target". By default, this draw target is the screen, but you can create images that can be drawn to, using maCreateDrawableImage().</p>
<p><!--break--></p>
<p>These mutable images behave exactly like any other images, and can be used with maDrawImage() or maDrawImageRegion() - the only difference is that they can't be transparent. Also, all drawing operations respect the "clip rectangle", which is a rectangular portion of the screen that is affected by drawing operations. By default, the clipping rectangle is the whole screen.</p>
<h2>Draw Targets</h2>
<div class="section"><p>To create an image you can draw to, you must have a placeholder resource to use. Either you can put one in the resource file for your application (see tutorial about resources), or you can create one dynamically at run time. We will demostrate how to create one dynamically:</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_type">MAHandle</span><span class="cpp_plain"> myPlaceholder </span><span class="cpp_operator">=</span><span class="cpp_plain"> maCreatePlaceholder</span><span class="cpp_separator">();</span><span class="cpp_plain"> </span></pre>
<p>Then, to create the drawable image:</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> maCreateDrawableImage</span><span class="cpp_separator">(</span><span class="cpp_plain">myPlaceholder</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_literal">32</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_literal">32</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span></pre>
<p>This will have created a 32x32 pixels drawable image. Now, to set the draw target to be this image:</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> maSetDrawTarget</span><span class="cpp_separator">(</span><span class="cpp_plain">myPlaceholder</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span></pre>
<p>This function returns the previously set target, and it might be a good idea to save that information. However, if you know that the previous target was the screen, you can just use the constant HANDLE_SCREEN to set it back:</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> maSetDrawTarget</span><span class="cpp_separator">(</span><span class="cpp_plain">HANDLE_SCREEN</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span></pre>
</div>
<!-- /div section --><div class="section"><h2>Clipping</h2>
<p>Clipping allows you to limit the part of the screen that can be drawn to. This might be useful when implementing graphical user interfaces, games or anything involving window-like behavior. Clipping rectangles are per draw target - that is, the screen and every drawable image has one. Consequently, you must take care to set the appropriate draw target using setDrawTarget() before specifying its clipping rectangle:</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain">maSetDrawTarget</span><span class="cpp_separator">(</span><span class="cpp_plain">myPlaceholder</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span>
 <span class="cpp_plain">maSetClipRect</span><span class="cpp_separator">(</span><span class="cpp_literal">0</span><span class="cpp_separator">,</span><span class="cpp_literal">0</span><span class="cpp_separator">,</span><span class="cpp_literal">16</span><span class="cpp_separator">,</span><span class="cpp_literal">16</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span></pre>
<p>To retrieve the current clip rect:</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_type">MARect</span><span class="cpp_plain"> myRect</span><span class="cpp_separator">;</span><span class="cpp_plain"> </span>
 <span class="cpp_plain">maGetClipRect</span><span class="cpp_separator">(</span><span class="cpp_operator">&amp;</span><span class="cpp_plain">myRect</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span></pre>
<h2>An Example</h2>
<pre class="mosync-code-cpp">#include &lt;MAUtil/Moblet.h&gt;
#include &lt;MAUtil/String.h&gt; 
#include &lt;mastdlib.h&gt; 

using namespace MAUtil; 

#define BORDER 40 class MyMoblet : public Moblet 
{
public: 

    MyMoblet() 
    { 
        MAExtent scrSize = maGetScrSize();
        
        int width = EXTENT_X(scrSize);
        int height = EXTENT_Y(scrSize);
        MAHandle myPlaceholder = maCreatePlaceholder();
        
        maCreateDrawableImage(myPlaceholder, 32, 32);
        maSetDrawTarget(myPlaceholder);        
        
        // Fill with blue 
        maSetColor(0x0000ff); 
        maFillRect(0, 0, 32, 32); 
        maSetColor(0xff00); 
        
        // draw green triangle 
        maLine(0,10,10,0); 
        maLine(0,0,0,10); 
        maLine(0,0,10,0); 
        maSetDrawTarget(HANDLE_SCREEN); 
        maSetClipRect(BORDER,BORDER,width-BORDER*2, height-BORDER*2); 
        
        // Draw purple background 
        maSetColor(0xff00ff); 
        maFillRect(0,0, 200, 200); 
        for(int i = 0; i &lt; 10; i++) 
        { 
            maDrawImage(myPlaceholder, i*40, i*40); 
        } 
        
        // Draw white text 
        maSetColor(0xffffff); 
        maDrawText(0,BORDER, "This text is also clipped"); 
        maUpdateScreen(); 
    } 
}; 

extern "C" int MAMain()
{
    Moblet::run(new MyMoblet());
    return 0; 
};</pre>
</div>
</body>
</html>
