<html>
<head>
<title>HTTP Connections</title>
</head>
<body>
<h1>HTTP Connections</h1>
<p>This tutorial will show you the basics of HTTP connections in MoSync. You will see how easy it is to write applications which can access HTTP-based information. You will also see how easy it is to stream information over HTTP. This example is written from a Moblet template.</p>
<p><!--break--></p>
<h2>Initializing</h2>
<pre class="code"><span class="cpp_preproc">#include</span><span class="cpp_plain"> </span><span class="cpp_operator">&lt;</span><span class="cpp_plain">mautil</span><span class="cpp_operator">/</span><span class="cpp_plain">connection</span><span class="cpp_separator">.</span><span class="cpp_plain">h</span><span class="cpp_operator">&gt;</span><span class="cpp_plain"> </span>
 <span class="cpp_preproc">#include</span><span class="cpp_plain"> </span><span class="cpp_operator">&lt;</span><span class="cpp_plain">mastdlib</span><span class="cpp_separator">.</span><span class="cpp_plain">h</span><span class="cpp_operator">&gt;</span><span class="cpp_plain"> </span>
 <span class="cpp_preproc">#include</span><span class="cpp_plain"> </span><span class="cpp_operator">&lt;</span><span class="cpp_plain">conprint</span><span class="cpp_separator">.</span><span class="cpp_plain">h</span><span class="cpp_operator">&gt;</span><span class="cpp_plain"> </span>
 <span class="cpp_preproc">#define</span><span class="cpp_plain"> CONNECTION_BUFFER_SIZE </span><span class="cpp_literal">1024</span><span class="cpp_plain"> </span></pre>
<p><em>connection.h</em> is included to provide the basic connection functionallity. <br><em>mastlib.h</em> is included to add the atoi function which converts the contents of an array to an int. <br><em>conprint.h</em> adds the printf function which writes text to the screen as a simple console. <br><em>CONNECTION_BUFFER_SIZE</em> defines the size of the buffer in which data is collected.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_keyword">class</span><span class="cpp_plain"> </span><span class="cpp_type">MyMoblet</span><span class="cpp_plain"> </span><span class="cpp_operator">:</span><span class="cpp_plain"> </span><span class="cpp_keyword">public</span><span class="cpp_plain"> </span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">Moblet</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_keyword">private</span><span class="cpp_plain"> </span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">HttpConnectionListener</span><span class="cpp_plain"> </span></pre>
<p>To provide the functionallity we inherit function declarations from the <em>HttpConnectionListener</em> class.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_keyword">void</span><span class="cpp_plain"> httpFinished</span><span class="cpp_separator">(</span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">HttpConnection</span><span class="cpp_plain"> </span><span class="cpp_operator">*</span><span class="cpp_plain">conn</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_type">int</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">void</span><span class="cpp_plain"> connRecvFinished</span><span class="cpp_separator">(</span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">Connection</span><span class="cpp_plain"> </span><span class="cpp_operator">*</span><span class="cpp_plain">conn</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_type">int</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">void</span><span class="cpp_plain"> connReadFinished</span><span class="cpp_separator">(</span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">Connection</span><span class="cpp_plain"> </span><span class="cpp_operator">*</span><span class="cpp_plain">conn</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_type">int</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span></pre>
<p>The <em>httpFinished</em> function is a callback which is called whenever a http connection is initiated and we can recieve a response. When we use the <em>recv</em> function for the http connection <em>connRecvFinished</em> is called everytime a new chunk of data is recieved. If we use the <em>read</em> function instead, the <em>connReadFinished</em> function will be called when the read is done. More about these functions later in this tutorial.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_type">char</span><span class="cpp_plain"> mBuffer</span><span class="cpp_separator">[</span><span class="cpp_plain">CONNECTION_BUFFER_SIZE</span><span class="cpp_separator">];</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">HttpConnection</span><span class="cpp_plain"> mHttp</span><span class="cpp_separator">;</span><span class="cpp_plain"> </span></pre>
<p>mHttp is a <em>MAUtil::HttpConnection</em> object which represents the actual connection. Each one of these may only handle one connection at the time so to enable multiple connections we need to define multiple <em>HttpConnection</em> objects. Always make sure that a connection is closed before connecting to it again.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_type">MyMoblet</span><span class="cpp_operator">::</span><span class="cpp_type">MyMoblet</span><span class="cpp_separator">()</span><span class="cpp_plain"> </span><span class="cpp_operator">:</span><span class="cpp_plain"> mHttp</span><span class="cpp_separator">(</span><span class="cpp_keyword">this</span><span class="cpp_separator">)</span><span class="cpp_plain"> </span></pre>
<p>The constructor sets itself as the listener for the <em>HttpConnection</em> object so that the callbacks declared in <em>MyMoblet</em> will be used.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_type">InitConsole</span><span class="cpp_separator">();</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> gConsoleLogging </span><span class="cpp_operator">=</span><span class="cpp_plain"> </span><span class="cpp_literal">1</span><span class="cpp_separator">;</span><span class="cpp_plain"> </span></pre>
<p>In our entry point, MAMain we initialize the console and enable logging. This means that everything that everything that we send to the console is also logged in a log file. If you handle large amount of data and would want to output information to verify behaviours of your application this will help you. This file is located in the <em>Output</em> folder of your project and is called <em>log.txt</em>.</p>
<h2>Connections and Responses</h2>
<p>Too initiate an http connection we call the <em>create</em> function of the <em>HttpConnection</em> object. All you need to provide is the url and if you need to use <em>GET</em> or <em>POST</em>. In this example we send a <em>POST</em> request to a server.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_type">int</span><span class="cpp_plain"> res </span><span class="cpp_operator">=</span><span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">create</span><span class="cpp_separator">(</span><span class="cpp_plain">url</span><span class="cpp_separator">,</span><span class="cpp_plain"> HTTP_POST</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">if</span><span class="cpp_separator">(</span><span class="cpp_plain">res </span><span class="cpp_operator">&lt;</span><span class="cpp_plain"> </span><span class="cpp_literal">0</span><span class="cpp_separator">)</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"unable&nbsp;to&nbsp;connect&nbsp;-&nbsp;%i\n"</span><span class="cpp_separator">,</span><span class="cpp_plain"> res</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"> </span><span class="cpp_keyword">else</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">finish</span><span class="cpp_separator">();</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> mIsConnected </span><span class="cpp_operator">=</span><span class="cpp_plain"> </span><span class="cpp_keyword">true</span><span class="cpp_separator">;</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"> </span></pre>
<p>If the <em>create</em> function returns a value below zero this means that it have failed for some reason. Please check the API references for all the possible return values. It's only possible to have one active connection on each <em>HttpConnection</em> object. Due to this we must make sure that we don't try to reconnect an active connection. If the <em>create</em> call was successful we can now set request headers. Since we don't need it we can call the <em>finish</em> function directly.</p>
<p>When we have a connection with the server the callback function <em>httpFinished</em> will be called.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_type">MAUtil</span><span class="cpp_operator">::</span><span class="cpp_type">String</span><span class="cpp_plain"> contentLengthStr</span><span class="cpp_separator">;</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_type">int</span><span class="cpp_plain"> responseBytes </span><span class="cpp_operator">=</span><span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">getResponseHeader</span><span class="cpp_separator">(</span><span class="cpp_literal">"content-length"</span><span class="cpp_separator">,</span><span class="cpp_plain"> </span><span class="cpp_operator">&amp;</span><span class="cpp_plain">contentLengthStr</span><span class="cpp_separator">);</span><span class="cpp_plain"> </span>
 <span class="cpp_plain"> </span><span class="cpp_type">int</span><span class="cpp_plain"> contentLength </span><span class="cpp_operator">=</span><span class="cpp_plain"> </span><span class="cpp_literal">0</span><span class="cpp_separator">;</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">if</span><span class="cpp_separator">(</span><span class="cpp_plain">responseBytes </span><span class="cpp_operator">==</span><span class="cpp_plain"> CONNERR_NOHEADER</span><span class="cpp_separator">)</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"no&nbsp;content-length&nbsp;response&nbsp;header\n"</span><span class="cpp_separator">);</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">else</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"content-length&nbsp;:&nbsp;%s\n"</span><span class="cpp_separator">,</span><span class="cpp_plain"> contentLengthStr</span><span class="cpp_separator">.</span><span class="cpp_plain">c_str</span><span class="cpp_separator">());</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> contentLength </span><span class="cpp_operator">=</span><span class="cpp_plain"> atoi</span><span class="cpp_separator">(</span><span class="cpp_plain">contentLengthStr</span><span class="cpp_separator">.</span><span class="cpp_plain">c_str</span><span class="cpp_separator">());</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain">&nbsp;</span></pre>
<p>First we check for the "content-length" response header, if it's not found we will recieve an <em>CONNERR_NOHEADER</em> response. If it's found we recieves the actual content length as an char array of numbers. It's then converted it to an int using the <em>atoi</em> function.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_keyword">if</span><span class="cpp_separator">(</span><span class="cpp_plain">contentLength </span><span class="cpp_operator">&gt;=</span><span class="cpp_plain"> CONNECTION_BUFFER_SIZE </span><span class="cpp_operator">||</span><span class="cpp_plain"> contentLength </span><span class="cpp_operator">==</span><span class="cpp_plain"> </span><span class="cpp_literal">0</span><span class="cpp_separator">)</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain">&nbsp;</span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"Receive&nbsp;in&nbsp;chunks..\n"</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">recv</span><span class="cpp_separator">(</span><span class="cpp_plain">mBuffer</span><span class="cpp_separator">,</span><span class="cpp_plain"> CONNECTION_BUFFER_SIZE</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"> </span><span class="cpp_keyword">else</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> mBuffer</span><span class="cpp_separator">[</span><span class="cpp_plain">contentLength</span><span class="cpp_separator">]</span><span class="cpp_plain"> </span><span class="cpp_operator">=</span><span class="cpp_plain"> </span><span class="cpp_literal">0</span><span class="cpp_separator">;</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">read</span><span class="cpp_separator">(</span><span class="cpp_plain">mBuffer</span><span class="cpp_separator">,</span><span class="cpp_plain"> contentLength</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"></span></pre>
<p>If we don't have any content length or it's larger then our recieving buffer we can't just read all the data. We have to read multiple times until we reaches the end. This is done by calling the <em>recv</em> function of the <em>HttpConnection</em> object.</p>
<p>If we know the content length and the recieving data fits inside the buffer we can read it all directly. This is done by using the <em>read</em> function in <em>HttpConnection</em>.</p>
<p>The difference between the two is that <em>recv</em> specifies the total amount of bytes which it can recieve while <em>read</em> specifies the number of bytes it shall read. Each of these methods has its own callback functions. Depending on the function you use <em>connRecvFinished</em> or <em>connReadFinished</em> callback functions will be called.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_keyword">if</span><span class="cpp_separator">(</span><span class="cpp_plain">result </span><span class="cpp_operator">&gt;=</span><span class="cpp_plain"> </span><span class="cpp_literal">0</span><span class="cpp_separator">)</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"connReadFinished&nbsp;%i\n"</span><span class="cpp_separator">,</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">else</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"connection&nbsp;error&nbsp;%i\n"</span><span class="cpp_separator">,</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">close</span><span class="cpp_separator">();</span><span class="cpp_plain"></span></pre>
<p>The <em>connReadFinished</em> callback function first check if the result is not negative. A negative result means an error might have happened. Check the return value against the API documentation. Positive results means that data was received. The connection shall be closed manually now since no more data will be received on this connection.</p>
<pre class="code"><!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --> <span class="cpp_plain"> </span><span class="cpp_keyword">if</span><span class="cpp_separator">(</span><span class="cpp_plain">result </span><span class="cpp_operator">&gt;=</span><span class="cpp_plain"> </span><span class="cpp_literal">0</span><span class="cpp_separator">)</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"connRecvFinished&nbsp;%i\n"</span><span class="cpp_separator">,</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">recv</span><span class="cpp_separator">(</span><span class="cpp_plain">mBuffer</span><span class="cpp_separator">,</span><span class="cpp_plain"> CONNECTION_BUFFER_SIZE</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">return</span><span class="cpp_separator">;</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_keyword">else</span><span class="cpp_plain"> </span><span class="cpp_keyword">if</span><span class="cpp_separator">(</span><span class="cpp_plain">result </span><span class="cpp_operator">==</span><span class="cpp_plain"> CONNERR_CLOSED</span><span class="cpp_separator">)</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"Receive&nbsp;finished!\n"</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"> </span><span class="cpp_keyword">else</span><span class="cpp_plain"> </span><span class="cpp_separator">{</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> printf</span><span class="cpp_separator">(</span><span class="cpp_literal">"connection&nbsp;error&nbsp;%i\n"</span><span class="cpp_separator">,</span><span class="cpp_plain"> result</span><span class="cpp_separator">);</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> </span><span class="cpp_separator">}</span><span class="cpp_plain"></span>
 <span class="cpp_plain"> mHttp</span><span class="cpp_separator">.</span><span class="cpp_plain">close</span><span class="cpp_separator">();</span><span class="cpp_plain"></span></pre>
<p>The <em>connRecvFinished</em> callback function works a little bit different. If the result is positive we have received that amount of bytes. If so we can't close the connection since more data will be received. If it's negative we must check if it's <em>CONNERR_CLOSED</em>. <em>CONNERR_CLOSED</em> doesn't need to be an error. Usually it means that the sending server has sent its data and closed the connection to verify the receiver about it. When a negative value is returned the connection shall be closed.</p>
<div class="section"><p>In this tutorial we have had a look at how easy it is to access HTTP information and also stream such information to your application. With this basic knowledge you will easily build your applications which will use web based information.</p>
<p>For further information also read the sockets tutorial and the tutorial concerning the downloader.</p>
<h2>Example Source Code</h2>
<pre class="mosync-code-cpp">#include &lt;MAUtil/Moblet.h&gt;
#include &lt;mautil/connection.h&gt;
#include &lt;mastdlib.h&gt;
#include &lt;conprint.h&gt;
#define CONNECTION_BUFFER_SIZE 1024
class MyMoblet : public MAUtil::Moblet, private MAUtil::HttpConnectionListener
{
public:
    MyMoblet();

    void httpFinished(MAUtil::HttpConnection *conn, int result);
    void connRecvFinished(MAUtil::Connection *conn, int result);
    void connReadFinished(MAUtil::Connection *conn, int result);
    void keyPressEvent(int keyCode);
private:
    void initiateConnection(const char* url);
    char mBuffer[CONNECTION_BUFFER_SIZE];
    MAUtil::HttpConnection mHttp;
    bool mIsConnected;
};
MyMoblet::MyMoblet() : mHttp(this)
, mIsConnected(false)
{
    printf("http connection tutorial.\n");
    printf("press softkeys to send http requests.\n");
    printf("press 0 to exit\n");
}
// connect to the given url if not other connection is active
void MyMoblet::initiateConnection(const char* url) {
    if(mIsConnected) {
        printf("already connected\n..");
        return;
    }
    printf("\nconnecting to %s", url);

    int res = mHttp.create(url, HTTP_POST);
    if(res &lt; 0) {
        printf("unable to connect - %i\n", res);
    } else {
        mHttp.finish();
        mIsConnected = true;
    }
}
void MyMoblet::httpFinished(MAUtil::HttpConnection* http, int result) {
    printf("HTTP %i\n", result);

    MAUtil::String contentLengthStr;
    int responseBytes = mHttp.getResponseHeader("content-length", &amp;contentLengthStr);
    int contentLength = 0;
    if(responseBytes == CONNERR_NOHEADER)
    printf("no content-length response header\n");
    else {
        printf("content-length : %s\n", contentLengthStr.c_str());
        contentLength = atoi(contentLengthStr.c_str());
    }
    if(contentLength &gt;= CONNECTION_BUFFER_SIZE || contentLength == 0) {
        printf("Receive in chunks..\n");
        mHttp.recv(mBuffer, CONNECTION_BUFFER_SIZE);
    } else {
        mBuffer[contentLength] = 0;
        mHttp.read(mBuffer, contentLength);
    }

}
void MyMoblet::connReadFinished(MAUtil::Connection* conn, int result) {
    if(result &gt;= 0)
    printf("connReadFinished %i\n", result);
    else
    printf("connection error %i\n", result);
    mHttp.close();

    mIsConnected = false;
}
void MyMoblet::connRecvFinished(MAUtil::Connection * conn, int result){
    if(result &gt;= 0) {
        printf("connRecvFinished %i\n", result);
        mHttp.recv(mBuffer, CONNECTION_BUFFER_SIZE);
        return;
    }
    else if(result == CONNERR_CLOSED) {
        printf("Receive finished!\n");
    } else {
        printf("connection error %i\n", result);
    }
    mHttp.close();
    mIsConnected = false;
}
// Press 0 to exit. Soft left and soft right will initiate new connections
void MyMoblet::keyPressEvent(int keyCode) {
    switch(keyCode) {

    case MAK_0:
        maExit(0);
        break;

    case MAK_SOFTLEFT:
        initiateConnection("http://www.example.com/");
        break;
    case MAK_SOFTRIGHT:
        initiateConnection("http://www.mosync.com/");
        break;
    }
}
extern "C" int MAMain() {
    InitConsole();
    gConsoleLogging = 1;
    MAUtil::Moblet::run(new MyMoblet());
}</pre>
</div>
<!-- temp.cpp : generated by JHighlight v(unknown version) (http://jhighlight.dev.java.net) --></body>
</html>
